import{r as c,d as N,e as v,f as w,j as e,A as P,X as F}from"./index-n4hANkp9.js";import{s as a,P as g,R,F as D,A as p,m as C}from"./MergePdf.module-CsgLC5TJ.js";import{P as M,R as k,a as z}from"./Item-BDfEjdxG.js";import{T as S}from"./trash-2-CaLfTa1W.js";import"./index-D7F2rPb2.js";const I=()=>Math.random().toString(36).substring(2,15),E=()=>{const[r,n]=c.useState([]),[j,h]=c.useState(!1),[i,f]=c.useState(null),{addToast:o}=N(),d=v(),u=w.useRef(!1);c.useEffect(()=>{!u.current&&d.state?.initialFiles&&(u.current=!0,m(d.state.initialFiles),window.history.replaceState({},document.title))},[d]);const m=s=>{try{const l=Array.from(s).map(t=>({file:t,id:I(),name:t.name,size:(t.size/1024/1024).toFixed(2)+" MB"}));n(t=>[...t,...l])}catch(l){console.error("Selection error:",l),o("Error processing selected files.","error")}},b=s=>{n(l=>l.filter(t=>t.id!==s))},y=async()=>{if(!(r.length<2)){h(!0),await new Promise(s=>setTimeout(s,1500));try{const s=await C(r.map(t=>t.file)),l=URL.createObjectURL(s);f(l),o("PDFs merged successfully!","success")}catch(s){console.error("Merge failed",s),o("Failed to merge PDFs. Please try again.","error")}finally{h(!1)}}},x=()=>{n([]),i&&URL.revokeObjectURL(i),f(null)};return i?e.jsx("div",{className:a.container,children:e.jsxs("div",{className:a.successCard,children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"rounded-lg overflow-hidden shadow-lg border border-slate-200 bg-white",children:e.jsx(g,{url:i,pageIndex:0,width:200})})}),e.jsx("h2",{className:a.title,children:"PDFs Merged!"}),e.jsx("p",{className:a.subtitle,style:{marginBottom:"2rem"},children:"Preview of your new file."}),e.jsxs("div",{className:"flex flex-col gap-6 items-center w-full max-w-[300px] mx-auto",children:[e.jsx("a",{href:i,download:`bamsense_merged_${Date.now()}.pdf`,className:"btn btn-action w-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all",children:"Download Merged PDF"}),e.jsxs("button",{onClick:x,className:"btn w-full bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors",children:[e.jsx(R,{size:16,className:"mr-2"}),"Merge more PDFs"]})]})]})}):e.jsxs("div",{className:a.container,children:[e.jsxs("div",{className:a.header,children:[e.jsx("h2",{className:a.title,children:"Merge PDF files"}),e.jsx("p",{className:a.subtitle,children:"Combine PDFs in the order you want with the easiest PDF merger available."})]}),r.length===0?e.jsx(D,{onFilesSelected:m}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[e.jsxs("span",{className:"text-sm font-medium text-secondary flex items-center gap-2",children:[e.jsx(p,{size:16,className:"text-accent-secondary"})," Drag items to reorder"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>document.getElementById("add-more-input").click(),className:"btn text-xs bg-accent-primary/10 text-accent-primary hover:bg-accent-primary/20 px-3 py-1.5 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(M,{size:14})," Add more"]}),e.jsxs("button",{onClick:x,className:"btn text-xs bg-red-50 text-red-600 hover:bg-red-100 px-3 py-1.5 rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(S,{size:14})," Clear all"]})]}),e.jsx("input",{id:"add-more-input",type:"file",accept:".pdf",multiple:!0,hidden:!0,onChange:s=>m(s.target.files)})]}),e.jsx(k,{axis:"y",values:r,onReorder:n,className:a.fileList,children:e.jsx(P,{initial:!1,children:r.map(s=>e.jsxs(z,{value:s,className:a.fileItem,initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("div",{className:"w-10 h-14 bg-slate-100 shrink-0 border border-slate-200 rounded overflow-hidden",children:e.jsx(g,{file:s.file,pageIndex:0,width:40})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:a.fileName,children:s.name}),e.jsx("span",{className:a.fileSize,children:s.size})]})]}),e.jsx("button",{onClick:()=>b(s.id),className:a.removeBtn,children:e.jsx(F,{size:18})})]},s.id))})}),e.jsxs("div",{className:a.actionBar,children:[e.jsx("button",{onClick:x,className:"btn",style:{background:"var(--bg-tertiary)"},children:"Cancel"}),e.jsxs("button",{onClick:y,disabled:r.length<2,className:"btn btn-action",style:{opacity:r.length<2?.5:1},children:["Merge PDF ",e.jsx(p,{size:18,className:"ml-2"})]})]})]}),j&&e.jsxs("div",{className:a.loadingOverlay,children:[e.jsx("div",{className:a.spinner}),e.jsx("p",{className:"mt-4 font-medium text-primary",children:"Merging your files..."})]})]})};export{E as default};
