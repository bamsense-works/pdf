import{c as P,r,d as C,e as k,f as F,j as e,S as R}from"./index-n4hANkp9.js";import{g as z,s as l,P as w,R as T,F as U,A as L,a as $}from"./MergePdf.module-CsgLC5TJ.js";import{T as A}from"./trash-2-CaLfTa1W.js";import"./index-D7F2rPb2.js";const D=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],E=P("circle-check",D),H=()=>{const[n,x]=r.useState(null),[v,h]=r.useState(0),[c,d]=r.useState(new Set),[y,u]=r.useState(!1),[o,g]=r.useState(null),{addToast:p}=C(),i=k(),b=F.useRef(!1);r.useEffect(()=>{!b.current&&i.state?.initialFiles&&i.state.initialFiles.length>0&&(b.current=!0,f(i.state.initialFiles),window.history.replaceState({},document.title))},[i]);const f=async a=>{if(a.length>0){const s=a[0];x(s);const t=await z(s);h(t),d(new Set)}},N=a=>{const s=new Set(c);s.has(a)?s.delete(a):s.add(a),d(s)},j=()=>Array.from(c).sort((s,t)=>s-t).map(s=>s+1).join(", "),S=async()=>{const a=j();if(!(!n||!a)){u(!0),await new Promise(s=>setTimeout(s,1e3));try{const s=await $(n,a),t=URL.createObjectURL(s);g(t),p("Pages extracted successfully!","success")}catch(s){console.error(s),p("Selection failed.","error")}finally{u(!1)}}},m=()=>{x(null),h(0),d(new Set),o&&URL.revokeObjectURL(o),g(null)};return o?e.jsx("div",{className:l.container,children:e.jsxs("div",{className:l.successCard,children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"rounded-lg overflow-hidden shadow-lg border border-slate-200 bg-white",children:e.jsx(w,{url:o,pageIndex:0,width:200})})}),e.jsx("h2",{className:l.title,children:"Split Complete!"}),e.jsxs("div",{className:"flex flex-col gap-6 items-center w-full max-w-[300px] mx-auto mt-6",children:[e.jsx("a",{href:o,download:"bamsense_extracted.pdf",className:"btn btn-action w-full shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all",children:"Download PDF"}),e.jsxs("button",{onClick:m,className:"btn w-full bg-slate-100 text-slate-600 hover:bg-slate-200 transition-colors",children:[e.jsx(T,{size:16,className:"mr-2"})," Split another"]})]})]})}):e.jsxs("div",{className:l.container,children:[e.jsxs("div",{className:l.header,children:[e.jsx("h2",{className:l.title,children:"Split PDF"}),e.jsx("p",{className:l.subtitle,children:"Select the pages you want to extract."})]}),n?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{size:20,className:"text-accent-secondary"}),e.jsx("span",{className:"font-semibold",children:n.name})]}),e.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[e.jsx(A,{size:16})," Change file"]})]}),e.jsx("div",{className:"text-center mb-6",children:e.jsxs("p",{className:"text-sm text-secondary",children:["Selected: ",e.jsx("span",{className:"font-bold text-accent-primary",children:c.size>0?j():"None"})]})}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"1rem",padding:"1rem",maxHeight:"60vh",overflowY:"auto",backgroundColor:"var(--bg-secondary)",borderRadius:"12px",border:"1px solid var(--border-color)"},children:Array.from({length:v}).map((a,s)=>{const t=c.has(s);return e.jsxs("div",{onClick:()=>N(s),className:`relative cursor-pointer rounded-lg overflow-hidden transition-all duration-200 border-2 group ${t?"border-accent-secondary ring-2 ring-accent-secondary/20":"border-transparent hover:border-slate-300"}`,children:[e.jsx(w,{file:n,pageIndex:s,width:150,className:"w-full pointer-events-none"}),e.jsx("div",{className:`absolute inset-0 transition-opacity duration-200 ${t?"bg-accent-secondary/20 opacity-100":"bg-black/0 opacity-0 group-hover:bg-black/5"}`}),e.jsx("div",{className:`absolute top-2 right-2 transition-all duration-200 ${t?"opacity-100 scale-100":"opacity-0 scale-90 group-hover:opacity-100"}`,children:e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center shadow-sm ${t?"bg-accent-secondary text-white":"bg-white text-slate-300 border border-slate-200"}`,children:t?e.jsx(E,{size:16}):e.jsx("div",{className:"w-4 h-4 rounded-full border border-slate-300"})})}),e.jsxs("div",{className:`absolute bottom-0 inset-x-0 p-1 text-center text-xs font-bold transition-colors ${t?"bg-accent-secondary text-white":"bg-black/50 text-white"}`,children:["Page ",s+1]})]},s)})}),e.jsxs("div",{className:l.actionBar,children:[e.jsx("button",{onClick:m,className:"btn",style:{background:"var(--bg-tertiary)"},children:"Cancel"}),e.jsxs("button",{onClick:S,className:"btn btn-action",disabled:c.size===0,children:["Extract Selection ",e.jsx(L,{size:18,className:"ml-2"})]})]})]}):e.jsx(U,{onFilesSelected:f,multiple:!1}),y&&e.jsx("div",{className:l.loadingOverlay,children:e.jsx("div",{className:l.spinner})})]})};export{H as default};
