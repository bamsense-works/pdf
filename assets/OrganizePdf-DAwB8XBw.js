import{r as n,d as F,e as R,f as C,j as e,a as k,m as j,A as S,R as D,X as O}from"./index-n4hANkp9.js";import{g as T,s as t,P as y,R as U,F as A,A as L,o as I}from"./MergePdf.module-CsgLC5TJ.js";import{T as E}from"./trash-2-CaLfTa1W.js";import"./index-D7F2rPb2.js";const $=()=>{const[r,u]=n.useState(null),[o,c]=n.useState([]),[v,h]=n.useState(!1),[l,g]=n.useState(null),{addToast:b}=F(),d=R(),p=C.useRef(!1);n.useEffect(()=>{!p.current&&d.state?.initialFiles&&d.state.initialFiles.length>0&&(p.current=!0,f(d.state.initialFiles),window.history.replaceState({},document.title))},[d]);const f=async s=>{if(s.length>0){const a=s[0];u(a);const i=await T(a),z=Array.from({length:i},(B,x)=>({id:`page-${x}`,originalIndex:x,displayNum:x+1,rotation:0}));c(z)}},N=s=>{c(a=>a.filter(i=>i.id!==s))},w=s=>{c(a=>a.map(i=>i.id===s?{...i,rotation:(i.rotation+90)%360}:i))},P=async()=>{if(!(!r||o.length===0)){h(!0),await new Promise(s=>setTimeout(s,800));try{const s=await I(r,o),a=URL.createObjectURL(s);g(a),b("PDF organized successfully!","success")}catch(s){console.error(s),b("Failed to organize PDF.","error")}finally{h(!1)}}},m=()=>{u(null),c([]),l&&URL.revokeObjectURL(l),g(null)};return l?e.jsx("div",{className:t.container,children:e.jsxs("div",{className:t.successCard,children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"rounded-lg overflow-hidden shadow-lg border border-slate-200 bg-white",children:e.jsx(y,{url:l,pageIndex:0,width:200})})}),e.jsx("h2",{className:t.title,children:"PDF Organized!"}),e.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[e.jsx("a",{href:l,download:"bamsense_organized.pdf",className:"btn btn-action w-full max-w-[300px]",children:"Download PDF"}),e.jsxs("button",{onClick:m,className:"btn text-secondary",children:[e.jsx(U,{size:16,className:"mr-2"})," Organize another"]})]})]})}):e.jsxs("div",{className:t.container,children:[e.jsxs("div",{className:t.header,children:[e.jsx("h2",{className:t.title,children:"Organize PDF"}),e.jsx("p",{className:t.subtitle,children:"Sort, rotate, or delete pages visually."})]}),r?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 px-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{size:20,className:"text-accent-secondary"}),e.jsx("span",{className:"font-semibold",children:r.name})]}),e.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors",children:[e.jsx(E,{size:16})," Remove file"]})]}),e.jsx("p",{className:"text-sm text-secondary text-center mb-4",children:"Hover pages for options."}),e.jsx(j.div,{layout:!0,style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"1rem",padding:"1rem"},children:e.jsx(S,{children:o.map(s=>e.jsxs(j.div,{layout:!0,className:"relative group",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},children:[e.jsx("div",{className:"rounded-lg overflow-hidden shadow-sm border-2 border-transparent hover:border-accent-tertiary transition-all bg-white",children:e.jsx(y,{file:r,pageIndex:s.originalIndex,width:180,rotation:s.rotation,className:"w-full"})}),e.jsx("div",{className:"absolute top-2 left-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:()=>w(s.id),className:"p-2 bg-white/90 hover:bg-blue-50 text-accent-primary rounded-lg shadow-sm backdrop-blur-sm border border-slate-200 transition-colors",title:"Rotate 90Â°",children:e.jsx(D,{size:18})})}),e.jsx("div",{className:"absolute top-2 right-2 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:()=>N(s.id),className:"p-2 bg-white/90 hover:bg-red-50 text-red-500 rounded-lg shadow-sm backdrop-blur-sm border border-slate-200 transition-colors",title:"Delete Page",children:e.jsx(O,{size:18})})}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-black/50 text-white text-xs px-2 py-0.5 rounded backdrop-blur-sm",children:s.displayNum})]},s.id))})}),e.jsxs("div",{className:t.actionBar,children:[e.jsx("button",{onClick:m,className:"btn",style:{background:"var(--bg-tertiary)"},children:"Cancel"}),e.jsxs("button",{onClick:P,className:"btn btn-action",disabled:o.length===0,children:["Save Changes ",e.jsx(L,{size:18,className:"ml-2"})]})]})]}):e.jsx(A,{onFilesSelected:f,multiple:!1}),v&&e.jsx("div",{className:t.loadingOverlay,children:e.jsx("div",{className:t.spinner})})]})};export{$ as default};
